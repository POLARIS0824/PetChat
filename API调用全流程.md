# PetChat API调用全流程文档

## 目录

1. [触发点与概述](#1-触发点与概述)
2. [调用链与函数流程](#2-调用链与函数流程)
3. [关键函数详解](#3-关键函数详解)
4. [数据模型设计](#4-数据模型设计)
5. [优化策略](#5-优化策略)

## 1. 触发点与概述

PetChat应用中的API调用是与AI大模型交互的核心环节，主要在三种场景下触发：

1. **用户发送聊天消息时**：用户在UI界面输入并发送消息时
2. **聊天分析触发时**：当累积足够的未处理消息(10条)需要分析时
3. **会话摘要生成时**：当历史消息过多(20条)需要进行摘要时

整个API调用流程设计合理、层次分明，遵循清晰的层级结构，从上至下依次为：
- **UI层** - ChatInput组件接收用户输入
- **ViewModel层** - PetChatViewModel处理消息并协调整个流程
- **Repository层** - PetChatRepository构建API请求并处理响应

## 2. 调用链与函数流程

### 2.1 用户发送消息触发的API调用

